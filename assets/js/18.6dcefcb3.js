(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{310:function(n,t,e){"use strict";e.r(t);var s=e(11),a=Object(s.a)({},(function(){var n=this,t=n._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h1",{attrs:{id:"pm2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pm2"}},[n._v("#")]),n._v(" pm2")]),n._v(" "),t("p",[t("a",{attrs:{href:"https://pm2.fenxianglu.cn/",target:"_blank",rel:"noopener noreferrer"}},[n._v("PM2中文网"),t("OutboundLink")],1)]),n._v(" "),t("p",[n._v("作用：管理node进程，简化node管理任务。")]),n._v(" "),t("p",[n._v("优点：")]),n._v(" "),t("ul",[t("li",[n._v("后台运行")]),n._v(" "),t("li",[n._v("停机重载")]),n._v(" "),t("li",[n._v("控制台检测")]),n._v(" "),t("li",[n._v("提供 http api")]),n._v(" "),t("li",[n._v("内建负载均衡（基于node cluster模块）")]),n._v(" "),t("li",[n._v("自动停止不稳定进程，避免无限循环")]),n._v(" "),t("li",[n._v("提供远程的事实api服务（node模块允许pm2进程管理器交互）")])]),n._v(" "),t("h2",{attrs:{id:"初步了解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初步了解"}},[n._v("#")]),n._v(" 初步了解")]),n._v(" "),t("p",[n._v("常用命令：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v(">> mkdir xxx 创建文件夹\n>> echo >xxx.js 创建xxx文件\n>> ls 查看当前目录\n>> dir 查看当前目录\n")])])]),t("ol",[t("li",[n._v("初始化环境 "),t("code",[n._v("npm init")]),n._v("或者"),t("code",[n._v("npm init -y")]),n._v("，生成 package.json")]),n._v(" "),t("li",[n._v("初始化环境 "),t("code",[n._v("npm init -y")])]),n._v(" "),t("li",[n._v("安装依赖 "),t("code",[n._v("cnpm install express")]),n._v("、"),t("code",[n._v("cnpm install pm2 -g")])]),n._v(" "),t("li",[n._v("验证pm2 "),t("code",[n._v("pm2 -v")])]),n._v(" "),t("li",[n._v("使用pm2启动node服务 "),t("code",[n._v("pm2 start index.js")]),n._v(",如下既是启动成功")])]),n._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[n._v("PS")]),n._v(" C:\\Users\\junnian\\Desktop\\pm2_demo> pm2 "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("start")]),n._v(" indexindex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("js\n"),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[PM2]")]),n._v(" Starting C:\\Users\\junnian\\Desktop\\pm2_demo\\index5000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("js in fork_mode "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("1 instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[PM2]")]),n._v(" Done"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("\n┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐\n│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │\n├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤\n│ 0  │ index              │ fork     │ 0    │ online    │ 0%       │ 27"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("4mb   │\n└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘\n"),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("PS")]),n._v(" C:\\Users\\junnian\\Desktop\\pm2_demo> pm2 "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("start")]),n._v(" index8000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("js\n")])])]),t("p",[n._v("pm2常用命令：")]),n._v(" "),t("ul",[t("li",[t("code",[n._v("pm2 start index.js")]),n._v(" 启动index.js进程")]),n._v(" "),t("li",[t("code",[n._v("pm2 start index.js --watch")]),n._v(" 启动index.js进程并监听，会即时重启服务")]),n._v(" "),t("li",[t("code",[n._v("pm2 list")]),n._v(" 查看当前管理进程")]),n._v(" "),t("li",[t("code",[n._v("pm2 log")]),n._v(" 查看当前日志")]),n._v(" "),t("li",[t("code",[n._v("pm2 stop id")]),n._v(" 停止指定id进程")]),n._v(" "),t("li",[t("code",[n._v("pm2 restart id")]),n._v(" 重新启动指定id进程")]),n._v(" "),t("li",[t("code",[n._v("pm2 delete id")]),n._v(" 删除指定id进程")])]),n._v(" "),t("p",[n._v("补充：VSCODE终端无法运行脚本的解决方式：")]),n._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[n._v("PS")]),n._v(" C:\\Windows\\system32> "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("get-ExecutionPolicy")]),n._v("\nRestricted\n"),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("PS")]),n._v(" C:\\Windows\\system32> "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("set-ExecutionPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n位于命令管道位置 1 的 cmdlet "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("Set-ExecutionPolicy")]),n._v("\n请为以下参数提供值:\nExecutionPolicy: RemoteSigned\n\n执行策略更改\n执行策略可帮助你防止执行不信任的脚本。更改执行策略可能会产生安全风险，如 https:"),t("span",{pre:!0,attrs:{class:"token operator"}},[n._v("/")]),n._v("go"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("microsoft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("com/fwlink/?LinkID=135170\n中的 about_Execution_Policies 帮助主题所述。是否要更改执行策略?\n"),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[Y]")]),n._v(" 是"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("Y"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("  "),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[A]")]),n._v(" 全是"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("A"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("  "),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[N]")]),n._v(" 否"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("N"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("  "),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[L]")]),n._v(" 全否"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("L"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("  "),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[S]")]),n._v(" 暂停"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("?"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" 帮助 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("默认值为“N”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(": Y\n"),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("PS")]),n._v(" C:\\Windows\\system32> "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("get-ExecutionPolicy")]),n._v("\nRemoteSigned\n")])])]),t("h2",{attrs:{id:"关于服务器-linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于服务器-linux"}},[n._v("#")]),n._v(" 关于服务器 Linux")]),n._v(" "),t("p",[n._v("在线云服务推荐："),t("a",{attrs:{href:"https://cn.aliyun.com/",target:"_blank",rel:"noopener noreferrer"}},[n._v("阿里云"),t("OutboundLink")],1),n._v("、"),t("a",{attrs:{href:"https://cloud.tencent.com/",target:"_blank",rel:"noopener noreferrer"}},[n._v("腾讯云"),t("OutboundLink")],1),n._v("等")]),n._v(" "),t("p",[n._v("管理Linux服务器或者进行向服务器传文件时，需要使用ssh客户端连接到服务器，使用Mac或者Linux桌面系统可以直接使用SSH命令，windows系统需要额外安装工作支持，推荐："),t("a",{attrs:{href:"https://www.xshell.com/zh/xshell/",target:"_blank",rel:"noopener noreferrer"}},[n._v("Xshell"),t("OutboundLink")],1),n._v("或者"),t("a",{attrs:{href:"https://www.openssh.com/portable.html#downloads",target:"_blank",rel:"noopener noreferrer"}},[n._v("OpenSSH"),t("OutboundLink")],1),n._v("、"),t("a",{attrs:{href:""}},[n._v("Git")])]),n._v(" "),t("p",[n._v("使用SSH连接linux服务器（准备好账户、密码和公网地址）: "),t("code",[n._v("ssh username@ip")]),n._v("，如下：按要求输入密码并选择是否保存SSH密钥，即可进入服务器：")]),n._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[n._v("Microsoft Windows "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("版本 10"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("19045"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("2673"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" Microsoft Corporation。保留所有权利。\n\nC:\\Users\\junnian>ssh root@47"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("108"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("233"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("39\nThe authenticity of host "),t("span",{pre:!0,attrs:{class:"token string"}},[n._v("'47.108.233.39 (47.108.233.39)'")]),n._v(" can"),t("span",{pre:!0,attrs:{class:"token string"}},[n._v("'t be established.\nECDSA key fingerprint is SHA256:ygmvjM7zUYovESAq8biGYVOLwD3Wn2KqPkG7Uz6AOe8.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),n._v("47"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("108"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("233"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("39"),t("span",{pre:!0,attrs:{class:"token string"}},[n._v("' (ECDSA) to the list of known hosts.\nroot@47.108.233.39'")]),n._v("s password:\nLast failed login: Thu Mar  9 19:12:03 CST 2023 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("from")]),n._v(" 27"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("227"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("244"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("45 on ssh:notty\nThere were 2 failed login attempts since the last successful login"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("\n\nWelcome to Alibaba Cloud Elastic Compute Service "),t("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v("\n\n"),t("span",{pre:!0,attrs:{class:"token namespace"}},[n._v("[root@iZ2vcc0d34kg5yk3n27ekyZ ~]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#")]),n._v("\n")])])]),t("p",[n._v("Linux 常用命令")]),n._v(" "),t("div",{staticClass:"language-linux extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("> ls 查看当前文件夹下所有文件\n> pwd 查看当前文件夹\n> cd .. 切换到上一级文件夹\n> cd ~  切换到家目录（刚进入系统的那个目录）\n> cd /  切换到根目录文件夹\n> wget https://nodejs.org/dist/v18.15.0/node-v18.15.0-linux-x64.tar.xz 下载指定文件\n> tar -xf node-v18.15.0-linux-x64.tar.xz 解压指定文件\n> $PATH 查看环境变量（冒号分隔）\n> vi xxx 使用vim编辑器打开当前目录指定文件\n\n> mkdir xxx 新建指定文件夹\n> touch index.js 新建index.js文件 \n\n> rm -f xxx 删除一个xxx文件\n> rmdir xxx 删除一个xxx目录\n> rm -rf xxx 删除一个xxx目录并同时删除其内容 \n")])])]),t("p",[n._v("使用"),t("code",[n._v("wget url")]),n._v("命令安装 "),t("a",{attrs:{href:"https://nodejs.org/en/download/",target:"_blank",rel:"noopener noreferrer"}},[n._v("node.js Linux 版"),t("OutboundLink")],1),n._v(" 二进制文件，Linux中使用鼠标右键粘贴内容。下载完成使用"),t("code",[n._v("tar -xvf node-v18.15.0-linux-x64.tar.xz")]),n._v("解压文件，并进入"),t("code",[n._v("/node-v18.15.0-linux-x64/bin")]),n._v("这个目录使用"),t("code",[n._v("ls")]),n._v("查看是否存在corepack  node  npm  npx文件，文件存在就使用"),t("code",[n._v("pwd")]),n._v("命令得到当前文件目录。")]),n._v(" "),t("p",[n._v("进入"),t("code",[n._v("/etc")]),n._v("目录，使用vim编辑器（i开启编辑模式,esc退出当前模式，"),t("code",[n._v(":wq")]),n._v("保存并退出编辑器）打开profile文件"),t("code",[n._v("vi profile")]),n._v("，添加"),t("code",[n._v("export PATH=$PATH:/node-v18.15.0-linux-x64/bin")]),n._v("一行，使用"),t("code",[n._v("source profile")]),n._v("刷新当前shell环境，然后退出当前服务器"),t("code",[n._v("exit")]),n._v("并重新登录，使用"),t("code",[n._v("node -v")]),n._v("、"),t("code",[n._v("npm -v")]),n._v("查看当前node版本。")]),n._v(" "),t("p",[n._v("在根文件使用mkdir新建node-server文件，并在此文件内新建server文件...")]),n._v(" "),t("p",[n._v("完成后使用 pm2 启动node服务，需要注意，此时需要在阿里云安全组配置面板中添加防火墙规则，将node服务端口开放暴露出去。")]),n._v(" "),t("p",[n._v("使用"),t("code",[n._v("pm2 monit")]),n._v("即可监听node服务日志")]),n._v(" "),t("h2",{attrs:{id:"linux系统文件属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux系统文件属性"}},[n._v("#")]),n._v(" Linux系统文件属性")]),n._v(" "),t("p",[t("code",[n._v("ls -l")]),n._v("（可简写为"),t("code",[n._v("ll")]),n._v("）即可查看当前文件夹下所有文件属性")]),n._v(" "),t("p",[n._v("第一列表示文件属性和权限列：首字母：-代表文件,d代表文件夹，l表示超链接，c表示硬件，b表示u盘等移动存储设备。首字母后的所有字母则每三个划分为一组，共三组，分别表示的创建者权限（读、写、可执行），所在用户组权限（读、写、可执行）和其他用户权限（读、写、可执行），如果有下划线，则表示该权限缺失（如目录不可执行，则执行权限全部为_）。")]),n._v(" "),t("p",[n._v("第二列表示文件数量，第三列表示用户名，第四列表示组名，第五列表示文件体积，第六列表示文件创建日期，第六列为文件名。")]),n._v(" "),t("p",[n._v("示例：")]),n._v(" "),t("div",{staticClass:"language-linux extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("[root@iZ2vcc0d34kg5yk3n27ekyZ /]# ll\ntotal 21964\nlrwxrwxrwx.  1 root root        7 Feb  8 10:15 bin -> usr/bin\ndr-xr-xr-x.  5 root root     4096 Feb  8 10:38 boot\ndrwxr-xr-x  19 root root     2960 Mar  9 19:10 dev\ndrwxr-xr-x. 80 root root     4096 Mar 10 03:02 etc\ndrwxr-xr-x.  2 root root     4096 Apr 11  2018 home\nlrwxrwxrwx.  1 root root        7 Feb  8 10:15 lib -> usr/lib\nlrwxrwxrwx.  1 root root        9 Feb  8 10:15 lib64 -> usr/lib64\ndrwx------.  2 root root    16384 Feb  8 10:15 lost+found\ndrwxr-xr-x.  2 root root     4096 Apr 11  2018 media\ndrwxr-xr-x.  2 root root     4096 Apr 11  2018 mnt\ndrwxr-xr-x   3 root root     4096 Mar 10 03:42 node-server\ndrwxr-xr-x   6 1001 1001     4096 Aug 16  2022 node-v16.17.0-linux-x64\n-rw-r--r--   1 root root 22419468 Aug 16  2022 node-v16.17.0-linux-x64.tar.xz\n[root@iZ2vcc0d34kg5yk3n27ekyZ /]#\n")])])]),t("h2",{attrs:{id:"linux权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux权限"}},[n._v("#")]),n._v(" Linux权限")]),n._v(" "),t("p",[n._v("新建文件"),t("code",[n._v("touch index.txt")])]),n._v(" "),t("p",[n._v("使用"),t("code",[n._v("adduser username")]),n._v("新建账户，使用"),t("code",[n._v("passpwd username")]),n._v("为账户指定密码")]),n._v(" "),t("p",[n._v("此时使用新建账户登录并尝试修改此文件时，会报错：无权限，且使用"),t("code",[n._v("ll")]),n._v("查看文件属性也会发现没有权限，如下：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("[junnian@iZ2vcc0d34kg5yk3n27ekyZ /]$ echo change>index.txt\n-bash: index.txt: Permission denied\n[junnian@iZ2vcc0d34kg5yk3n27ekyZ /]$ ll\ntotal 21968\n-rw-r--r--    1 root root        6 Mar 10 11:35 index.txt\n[junnian@iZ2vcc0d34kg5yk3n27ekyZ /]$ echo change>index.txt\n")])])]),t("p",[n._v("此时需要到root账户下使用"),t("code",[n._v("chmod")]),n._v("命令为文件指定权限："),t("code",[n._v("[root@iZ2vcc0d34kg5yk3n27ekyZ /]# chmod 777 index.txt")]),n._v("，回到新建账户尝试修改文件，已经可以正常读写文件了:")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("[junnian@iZ2vcc0d34kg5yk3n27ekyZ /]$ echo change>index.txt\n[junnian@iZ2vcc0d34kg5yk3n27ekyZ /]$ cat index.txt\nchange\n")])])]),t("p",[n._v("关于"),t("code",[n._v("chmod")]),n._v("命令可以参考这篇文章:"),t("a",{attrs:{href:"https://www.runoob.com/linux/linux-comm-chmod.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Linux chmod命令"),t("OutboundLink")],1)]),n._v(" "),t("h2",{attrs:{id:"了解nignx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#了解nignx"}},[n._v("#")]),n._v(" 了解Nignx")]),n._v(" "),t("p",[n._v("Nignx是使用c开发的一个高性能http服务器，支持正反向代理（正向代理服务器，反向代理客户端）、负载均衡（轮询+权重），动静分离等特性。并且官方测试最高支持50,000个并发连接响应。")]),n._v(" "),t("h3",{attrs:{id:"安装nignx方式1-简单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nignx方式1-简单"}},[n._v("#")]),n._v(" 安装Nignx方式1（简单）")]),n._v(" "),t("p",[n._v("使用："),t("code",[n._v("yum install nignx")]),n._v("即可")]),n._v(" "),t("h3",{attrs:{id:"安装nignx方式2-自行搭建安装环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nignx方式2-自行搭建安装环境"}},[n._v("#")]),n._v(" 安装Nignx方式2（自行搭建安装环境）")]),n._v(" "),t("p",[n._v("补充：yum类似与node中的npm包管理工具")]),n._v(" "),t("ol",[t("li",[n._v("安装gcc环境，"),t("code",[n._v("[root@iZ2vcc0d34kg5yk3n27ekyZ ~]# yum install gcc-c++")])]),n._v(" "),t("li",[n._v("安装PCRE pcre-devel（基于pcre的二次开发库），nginx的http模块使用pcre来解析正则表达式。"),t("code",[n._v("yum install -y pcre pcre-devel")])]),n._v(" "),t("li",[n._v("安装 zlib 库，提供多种压缩和解压缩的方式， nginx 使用 zlib 对 http 包的内容进行 gzip 。"),t("code",[n._v("yum install -y zlib zlib-devel")])]),n._v(" "),t("li",[n._v("安装 OpenSSL，一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及 SSL 协议，并提供丰富的应用程序供测试或其它目的使用。"),t("code",[n._v("yum install -y openssl openssl-devel")])]),n._v(" "),t("li",[n._v("下载Nginx，"),t("code",[n._v("wget https://nginx.org/download/nginx-1.19.9.tar.gz")])]),n._v(" "),t("li",[n._v("解压nginx，"),t("code",[n._v("tar -zxvf nginx-1.19.9.tar.gz")])]),n._v(" "),t("li",[n._v("执行nginx/configure文件")]),n._v(" "),t("li",[n._v("编译文件会生成MakeFile文件夹，"),t("code",[n._v("make")]),n._v("。编译完成之后安装，"),t("code",[n._v("make install")])]),n._v(" "),t("li",[n._v("查询nginx安装位置，"),t("code",[n._v("whereis nginx")])]),n._v(" "),t("li",[n._v("进入安装位置并执行nginx")]),n._v(" "),t("li",[n._v("将nginx加入环境变量，"),t("code",[n._v("/user/local/nginx/sbin")]),n._v(",重启服务器")])]),n._v(" "),t("p",[n._v("现在尝试访问服务器80端口，需要提前开启80端口防火墙。")]),n._v(" "),t("h2",{attrs:{id:"nginx常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx常用命令"}},[n._v("#")]),n._v(" nginx常用命令")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("nginx -v\nnginx 启动nginx\nps -ef 查看当前系统所有进程\nps -ef | grep nginx 查看当前系统所有进程，并找出nginx进程\nnginx -s stop 停止进程\nnginx -s quit 停止进程（优雅停止）\nnginx -s reload 重载nginx配置文件,刷新nginx缓存（nginx.conf）\nnginx -t 检查nginx.conf是否有语法错误，会同时暴露nginx.conf地址\n")])])]),t("p",[n._v("补充nginx.conf:")]),n._v(" "),t("ul",[t("li",[n._v("全局块：（user：指定用户/用户组（windows不支持）；worker_processes：配置nginx进程；error-log：错误日志；pid文件）")]),n._v(" "),t("li",[n._v("events块：（accept_mutex:优化werker串行处理，默认开启；worker_connections:单个进程最大连接数）")]),n._v(" "),t("li",[n._v("http块\n"),t("ul",[t("li",[n._v("server块（可以存在多个）\n"),t("ul",[t("li",[n._v("listen（指定监听端口/IP）")]),n._v(" "),t("li",[n._v("location块（匹配模式，支持正则）")])])]),n._v(" "),t("li",[n._v("include块（引入其它配置）")]),n._v(" "),t("li",[n._v("sendfile块（减少静态系统切换）")]),n._v(" "),t("li",[n._v("log_format块（日志处理）")]),n._v(" "),t("li",[n._v("gzip（开启gzip压缩）")])])])]),n._v(" "),t("h2",{attrs:{id:"nginx-反向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-反向代理"}},[n._v("#")]),n._v(" nginx 反向代理")]),n._v(" "),t("p",[n._v("如需要访问:http://47.108.233.39:5001/api/list服务，则nginx配置文件修改如下，80端口代理到指定域名：")]),n._v(" "),t("div",{staticClass:"language-config extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("http {\n    server: {\n        listin 80;\n        location /api { ## /api请求均会被转发到代理服务器\n            proxy_pass http://47.108.233.39:5001/;\n        }\n    }\n}\n")])])]),t("p",[n._v("使用"),t("code",[n._v("nginx -s reload")]),n._v("刷新nginx服务，即可尝试访问。")]),n._v(" "),t("h2",{attrs:{id:"vue项目-history模式下路由刷新404"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vue项目-history模式下路由刷新404"}},[n._v("#")]),n._v(" Vue项目 history模式下路由刷新404")]),n._v(" "),t("p",[n._v("问题描述：当Vue项目使用了history模式时，路由跳转后刷新出现404。")]),n._v(" "),t("p",[n._v("原因：服务器是根据页面url寻找资源的。但vue项目是单页面应用，打包好的web站点只有一个html页面，不存在其他资源目录下的html，服务器找不到对应页面所以报404。")]),n._v(" "),t("p",[n._v("解决方案:根路径下配置如下：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("server {\n    loaction / {\n        try_files $uri $uri/ /index.html;\n    }\n}\n")])])]),t("p",[n._v("这句命令的意思是如果给出的file都没有匹配到，则重新请求最后一个参数给定的uri，就是新的location匹配。")]),n._v(" "),t("h2",{attrs:{id:"添加日志分析工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加日志分析工具"}},[n._v("#")]),n._v(" 添加日志分析工具")]),n._v(" "),t("p",[n._v("P.S. 执行"),t("code",[n._v("try_files $uri $uri/ /index.html;")]),n._v("并重启即可将Linux命令提示设置为中文")]),n._v(" "),t("p",[n._v("GoAccess是一款开源、实时，运行在命令行终端下的web日志分析工具。该工具提供快速、多样的HTTP状态统计，可以令管理员不再纠结于统计各类数据，和繁杂的指令以及一大堆管道/正则表达式。")]),n._v(" "),t("p",[t("a",{attrs:{href:"https://www.goaccess.cc/?mod=man",target:"_blank",rel:"noopener noreferrer"}},[n._v("GoAccess 操作手册"),t("OutboundLink")],1),n._v(",依照文档下载安装即可")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("$ wget http://tar.goaccess.io/goaccess-1.2.tar.gz\n$ tar -xzvf goaccess-1.2.tar.gz\n$ cd goaccess-1.2/\n$ ./configure\n$ make\n# make install\n")])])]),t("p",[n._v("安装完成后,就可以全局使用"),t("code",[n._v("goaccess")]),n._v("命令了，此时进入nginx/logs/access.log文件，常规方式是使用"),t("code",[n._v("cat access.log")]),n._v(",安装成功goaccess后，则可以使用"),t("code",[n._v("goaccess -f access.log")]),n._v(",选择格式化模式即可格式化查看")]),n._v(" "),t("p",[n._v("注意：make命令可能会报错:"),t("code",[n._v("configure: error: *** Missing development libraries for ncurses")]),n._v("。解决方式：根目录运行"),t("code",[n._v("yum -y install ncurses-devel")]),n._v("命令，安装ncurses-devel库即可")]),n._v(" "),t("h2",{attrs:{id:"nginx-负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-负载均衡"}},[n._v("#")]),n._v(" Nginx 负载均衡")]),n._v(" "),t("p",[n._v("Nginx 负载均衡共有三种方式：")]),n._v(" "),t("ul",[t("li",[n._v("轮询方式负载（默认）")]),n._v(" "),t("li",[n._v("负载权重分配")]),n._v(" "),t("li",[n._v("负载超时分配")])]),n._v(" "),t("p",[n._v("默认负载：")]),n._v(" "),t("div",{staticClass:"language-nginx.conf extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("http {\n\n    upstream node {\n        server 47.108.233.39:5000;\n        server 47.108.233.39:5001;\n        server 47.108.233.39:5003;\n    }\n\n    server {\n        listen       80;\n        server_name  localhost;\n        location / {\n                # root   html;\n                # index  index.html index.htm;\n                proxy_pass http://node;\n        }\n    }\n}\n")])])]),t("p",[n._v("按照权重weight 配置负载（权重与负载成正比关系，权重越大服务器承载的并发就越高）：")]),n._v(" "),t("div",{staticClass:"language-nginx.conf extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("upstream node {\n    server 47.108.233.39:5000 weight=3;\n    server 47.108.233.39:5001 weight=2;\n    server 47.108.233.39:5003 weight=1;\n}\n")])])]),t("p",[n._v("按照故障等待超时时间fail_timeout backup，配置负载（backup是备用服务器参数，可以为一个upstream设置一个backup的server，在生产server全部都出问题之后，可以自动切换到备用server上，为回复服务争取时间）")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("upstream  node {\n    server 47.108.233.39:5000 fail_timeout=60;\n    server 47.108.233.39:5001 fail_timeout=20;\n    server 47.108.233.39:5003 backup;\n}\n")])])])])}),[],!1,null,null,null);t.default=a.exports}}]);